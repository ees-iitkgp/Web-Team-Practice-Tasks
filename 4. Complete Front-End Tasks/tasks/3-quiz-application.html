<!--
	Task 3: Quiz Webpage

	Task Objective:
	You will have to make a fully-functioning Quiz Application, with 10 questions, a timer, navigation and a results page which is visible on submission.
	
	Note: Imagine your JEE Mains interface as an example

	1. You will have 10 questions stored in an array in a script tag. The array will have an oblect with question number, question, options and correct option.
		- For simplicity reasons, let us assume that all questions will be single correct MCQs only.
	
	2. On loading the webpage, the timer (let's say for 5 minutes) starts, counting down with every second.

	3. The user should be allowed to select an option, clear your selection, and freely navigate between questions.

	4. When the time is up, or on clicking a submit button (in the last question), a results page with a table of attempts and correct answer should be visible.

	5. If you have the time, try to add a starting instructions page with a "Start Quiz" button to start the quiz. You can also add an instructions page such that
	the timer keeps running nevertheless (kinda like the JEE portal too)

	Bonus: If you can integrate integer type question too, it would be wonderful.

	Your task will be judged on the functioning of the application and the styling of the components. A very show-off or glamorous interface is not what we expect,
	but just a neat user interface using which is not a hassle is well-appreciated. That being said, the 
-->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Application</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f4f4f4;
    }

    .container {
      width: 90%;
      max-width: 700px;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    h1, h2 {
      text-align: center;
      color: #333;
    }

    .question {
      margin: 20px 0;
    }

    .options {
      margin: 10px 0;
    }

    .options label {
      display: block;
      margin: 5px 0;
    }

    .timer, .navigation, .result-page {
      text-align: center;
      margin: 10px 0;
    }

    .navigation button {
      margin: 5px;
    }

    .result-page table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .result-page th, .result-page td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    .result-page th {
      background-color: #f2f2f2;
    }

    button {
      background-color: #007BFF;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Quiz Application</h1>
    <div class="instructions">
      <p>Welcome! Click below to start the quiz. You will have 5 minutes to complete it.</p>
      <button id="startQuiz">Start Quiz</button>
    </div>
    <div class="quiz" style="display:none;">
      <div class="timer">Time Left: <span id="timer">5:00</span></div>
      <div class="question"></div>
      <div class="options"></div>
      <div class="navigation">
        <button id="prev">Previous</button>
        <button id="next">Next</button>
        <button id="submit">Submit</button>
      </div>
    </div>
    <div class="result-page" style="display:none;">
      <h2>Quiz Results</h2>
      <table>
        <thead>
          <tr>
            <th>Question</th>
            <th>Your Answer</th>
            <th>Correct Answer</th>
            <th>Result</th>
          </tr>
        </thead>
        <tbody id="resultTable"></tbody>
      </table>
    </div>
  </div>

  <script>
    const questions = [
      { type: 'multiple', question: 'What is 2+2?', options: ['3', '4', '5'], correct: ['4'] },
      { type: 'numerical', question: 'Enter the value of Ï€ (approx)', correct: ['3.14'] },
      { type: 'string', question: 'Who was in Paris?', correct: ['Niggas'] }
    ];

    let currentQuestion = 0;
    let userAnswers = Array(questions.length).fill(null);
    let timeLeft = 300;

    const startQuiz = () => {
      document.querySelector('.instructions').style.display = 'none';
      document.querySelector('.quiz').style.display = 'block';
      loadQuestion();
      startTimer();
    };

    const loadQuestion = () => {
      const q = questions[currentQuestion];
      const questionDiv = document.querySelector('.question');
      const optionsDiv = document.querySelector('.options');
      questionDiv.textContent = `Q${currentQuestion + 1}: ${q.question}`;
      optionsDiv.innerHTML = '';

      if (q.type === 'multiple') {
        q.options.forEach((option, idx) => {
          optionsDiv.innerHTML += `
            <label>
              <input type="radio" name="answer" value="${option}" ${userAnswers[currentQuestion] === option ? 'checked' : ''}> ${option}
            </label>`;
        });
      } else if (q.type === 'numerical' || q.type === 'string') {
        optionsDiv.innerHTML = `
          <input type="text" name="answer" value="${userAnswers[currentQuestion] || ''}" style="width: 100%; padding: 8px;">`;
      }
    };

    const saveAnswer = () => {
      const q = questions[currentQuestion];
      if (q.type === 'multiple') {
        const selectedOption = document.querySelector('input[name="answer"]:checked');
        userAnswers[currentQuestion] = selectedOption ? selectedOption.value : null;
      } else {
        const inputField = document.querySelector('input[name="answer"]');
        userAnswers[currentQuestion] = inputField ? inputField.value : null;
      }
    };

    const navigateQuestion = (direction) => {
      saveAnswer();
      currentQuestion += direction;
      if (currentQuestion < 0) currentQuestion = 0;
      if (currentQuestion >= questions.length) currentQuestion = questions.length - 1;
      loadQuestion();
    };

    const startTimer = () => {
      const timerDiv = document.getElementById('timer');
      const timerInterval = setInterval(() => {
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          submitQuiz();
          return;
        }
        timeLeft--;
        const minutes = Math.floor(timeLeft / 60).toString().padStart(2, '0');
        const seconds = (timeLeft % 60).toString().padStart(2, '0');
        timerDiv.textContent = `${minutes}:${seconds}`;
      }, 1000);
    };

    const submitQuiz = () => {
      saveAnswer();
      document.querySelector('.quiz').style.display = 'none';
      document.querySelector('.result-page').style.display = 'block';
      const resultTable = document.getElementById('resultTable');
      resultTable.innerHTML = '';

      questions.forEach((q, idx) => {
        const userAnswer = userAnswers[idx] || 'No Answer';
        const correctAnswer = Array.isArray(q.correct) ? q.correct.join(', ') : q.correct;

        let isCorrect = false;
        if (q.type === 'numerical') {
          const userNum = parseFloat(userAnswer);
          const correctNum = parseFloat(q.correct[0]);
          isCorrect = !isNaN(userNum) && Math.abs((userNum - correctNum) / correctNum) <= 0.01;
        } else if (q.type === 'string') {
          const cleanedUser = userAnswer.replace(/\s+/g, '').toLowerCase();
          const cleanedCorrect = q.correct[0].replace(/\s+/g, '').toLowerCase();
          isCorrect = cleanedUser === cleanedCorrect;
        } else if (q.type === 'multiple') {
          isCorrect = q.correct.includes(userAnswer);
        }

        resultTable.innerHTML += `
          <tr>
            <td>${q.question}</td>
            <td>${userAnswer}</td>
            <td>${correctAnswer}</td>
            <td>${isCorrect ? 'Correct' : 'Incorrect'}</td>
          </tr>`;
      });
    };

    document.getElementById('startQuiz').addEventListener('click', startQuiz);
    document.getElementById('prev').addEventListener('click', () => navigateQuestion(-1));
    document.getElementById('next').addEventListener('click', () => navigateQuestion(1));
    document.getElementById('submit').addEventListener('click', submitQuiz);
  </script>
</body>
</html>
